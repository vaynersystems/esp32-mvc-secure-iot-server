<link rel="stylesheet" type="text/css" href="/CSS/config.css"/>
<div class="config-view">

    <div class="config-menu">
        <div class="menu-item">
            <div class="menu-header">Devices</div>
            <ul>
                <li id="devices">Manage Devices</li>
                <li id="schedules">Manage Schedules</li>
            </ul>
        </div>
        <div class="menu-item">
            <div class="menu-header">Network</div>
            <ul>
                <li id="wifi">Wifi</li>
                <!-- <li>IP</li> -->
            </ul>
        </div>
        <div class="menu-item">
            <div class="menu-header">System</div>
            <ul>
                <li id="system">General</li>
                <li id="ntp">NTP</li>
                <li id="theme">Theme</li>
            </ul>
        </div>
        <div class="menu-item">
            <div class="menu-header">Server</div>
            <ul>
                <li id="boot">Boot</li>
                <li id="backup">Backup</li>
                <li id="restore">Restore</li>
                <li id="reset">Reset</li>
            </ul>
        </div>
    </div>
    <div class="config-content">
        <div id="config-content">

        </div>
        <div class="config-actions">
            <button onclick="seveSettingsFromForm()">Save</button>
        </div>
    </div>
    
    <div id="error"></div>

    <div class="hidden" id="section-collection">
        <div class="section" name="devices">
            <div class="section-header">Device Manager</div>
            <div class="section-content flex grow">
                <div class="grid grid-header">
                    <div>ID</div>
                    <div>Name</div>
                    <div>Type</div>
                    <div>Pin</div>
                    <div>Actions</div>                    
                </div>
                <div class="" id="device-list">                                               
                </div>
                <div class="row">
                    <button type="button"  onclick="showDeviceEditor()">Add</button>
                </div>
            </div>
        </div>
        <div class="section" name="schedules">
            <div class="section-header">Schedule Manager</div>
            <div class="section-content"></div>
        </div>
        <div class="section" name="wifi">
            <div class="section-header">Wifi Settings</div>
            <div class="section-content">
                <div class="grid-2">
                    <span>Wifi Mode</span>
                    <select name="network-mode" id="network-mode">
                        <option value="access-point">Acess Point</option>
                        <option  value="client">Client</option>
                    </select>                
                </div>
                <div id="wifi-access-point" class="hidden">
                    <div class="grid-2">
                        <div>Name your Access Point</div>
                        <input type="text" name="wifi-network-name" id="wifi-network-name">
                    </div>
                    <div class="grid-2">
                        <div>Secure your Access Point (optional password)</div>
                        <input type="text" name="wifi-network-password" id="wifi-network-password">
                    </div>
                    <div class="grid-2">
                        <div>IP Address of the access point</div>
                        <input type="text" name="wifi-network-ap-ip" id="wifi-network-ap-ip">
                    </div>
                    <div class="grid-2">
                        <div>Subnet Mask</div>
                        <input type="text" name="wifi-network-ap-subnet" id="wifi-network-ap-subnet">
                    </div>
    
                </div>
                <div id="wifi-client" class="hidden">
                    <div class="grid-2">
                        <div class="row">
                            <div>Wifi Network</div>
                            <div id="wifi-wait" class="wait"></div>
                        </div>
                        <div class="row">                        
                            <select name="wifi-network" id="wifi-network"></select>
                            <button onclick="getAvailableWifiNetworks()">Refresh</button>
                        </div>
                    </div>
                    <div class="grid-2">
                        <div>Network Password</div>
                        <div>
                            <input type="password" id="wifi-network-password" value=""/>                         
                        </div>
                        
                    </div>
                    <div class="grid-2">
                        <div>Use DHCP</div>
                        <div>
                            <label for="wifi-network-dhcp-yes">Yes</label>
                            <input type="radio" id="wifi-network-dhcp-yes" name="wifi-network-dhcp" value="dhcp" checked/>
                            <label for="wifi-network-dhcp-no">No</label>
                            <input type="radio" id="wifi-network-dhcp-no" name="wifi-network-dhcp" value="manual" />
                        </div>
                        
                    </div>
                    <div id="wifi-client-dhcp" class="hidden">
    
                    </div>
                    <div id="wifi-client-manual" class="hidden">
                        <div class="grid-2">
                            <div>IP Address</div>
                            <input type="text" name="wifi-network-client-ip" id="wifi-network-client-ip">
                        </div>
                        <div class="grid-2">
                            <div>Subnet Mask <span class="hint"> e.g. 255.255.0.0</span></div>
                            <input type="text" name="wifi-network-client-subnet" id="wifi-network-client-subnet">
                        </div>
                        <div class="grid-2">
                            <div>Gateway IP</div>
                            <input type="text" name="wifi-network-client-gateway" id="wifi-network-client-gateway">
                        </div>
                        <div class="grid-2">
                            <div>DNS IP</div>
                            <input type="text" name="wifi-network-client-dns" id="wifi-network-client-dns">
                        </div>
                    </div>
                    
                </div>
            </div>
            
            
        </div>
        <div class="section" name="system">
            <div class="section-header">System Manager</div>
            <div class="section-content">
                <div class="grid-2">
                    <span>Host Name</span>
                    <input type="text" name="host-name" id="host-name"/>                        
                </div> 
                <div class="grid-2">
                    <span>Enable SSL</span>
                    <input type="checkbox" name="host-enable-ssl" id="host-enable-ssl"/>                        
                </div> 
                <div class="grid-2">
                    <span>Enable MDNS</span>
                    <input type="checkbox" name="host-enable-msdns" id="host-enable-msdns"/>                        
                </div>               
            </div>
        </div>
        <div class="section" name="ntp">
            <div class="section-header">NTP</div>
            <div class="section-content">
                <div class="grid-2">
                    <span>Device Time</span>
                    <div name="device-time" id="device-time">$_TIME (GMT)</div>
                </div> 
                <div class="grid-2">
                    <span>NTP Server</span>
                    <input type="text" name="ntp-host-name" id="ntp-host-name"/>                        
                </div> 
                <div class="grid-2">
                    <span>Time Zone</span>
                    <select name="time-zone" id="time-zone">
                        <option value="-12">(GMT -12:00) Eniwetok, Kwajalein</option>
                        <option value="-11">(GMT -11:00) Midway Island, Samoa</option>
                        <option value="-10">(GMT -10:00) Hawaii</option>
                        <option value="-9">(GMT -9:00) Alaska</option>
                        <option value="-8">(GMT -8:00) Pacific Time (US &amp; Canada)</option>
                        <option value="-7">(GMT -7:00) Mountain Time (US &amp; Canada)</option>
                        <option value="-6">(GMT -6:00) Central Time (US &amp; Canada), Mexico City</option>
                        <option value="-5">(GMT -5:00) Eastern Time (US &amp; Canada), Bogota, Lima</option>
                        <option value="-4">(GMT -4:00) Atlantic Time (Canada), Caracas, La Paz</option>
                        <option value="-3.5">(GMT -3:30) Newfoundland</option>
                        <option value="-3">(GMT -3:00) Brazil, Buenos Aires, Georgetown</option>
                        <option value="-2">(GMT -2:00) Mid-Atlantic</option>
                        <option value="-1">(GMT -1:00 hour) Azores, Cape Verde Islands</option>
                        <option selected="selected" value="0">(GMT) Western Europe Time, London, Lisbon, Casablanca</option>
                        <option value="1">(GMT +1:00 hour) Brussels, Copenhagen, Madrid, Paris</option>
                        <option value="2">(GMT +2:00) Kaliningrad, South Africa</option>
                        <option value="3">(GMT +3:00) Baghdad, Riyadh, Moscow, St. Petersburg</option>
                        <option value="3.5">(GMT +3:30) Tehran</option>
                        <option value="4">(GMT +4:00) Abu Dhabi, Muscat, Baku, Tbilisi</option>
                        <option value="4.5">(GMT +4:30) Kabul</option>
                        <option value="5">(GMT +5:00) Ekaterinburg, Islamabad, Karachi, Tashkent</option>
                        <option value="5.5">(GMT +5:30) Bombay, Calcutta, Madras, New Delhi</option>
                        <option value="5.75">(GMT +5:45) Kathmandu</option>
                        <option value="6">(GMT +6:00) Almaty, Dhaka, Colombo</option>
                        <option value="7">(GMT +7:00) Bangkok, Hanoi, Jakarta</option>
                        <option value="8">(GMT +8:00) Beijing, Perth, Singapore, Hong Kong</option>
                        <option value="9">(GMT +9:00) Tokyo, Seoul, Osaka, Sapporo, Yakutsk</option>
                        <option value="9.5">(GMT +9:30) Adelaide, Darwin</option>
                        <option value="10">(GMT +10:00) Eastern Australia, Guam, Vladivostok</option>
                        <option value="11">(GMT +11:00) Magadan, Solomon Islands, New Caledonia</option>
                        <option value="12">(GMT +12:00) Auckland, Wellington, Fiji, Kamchatka</option>
                    </select>                       
                </div> 
            </div>
        </div>
        <div class="section" name="theme">
            <div class="section-header">Site Style</div>
            <div class="section-content">
                <div class="grid-2">
                    <span>Theme</span>
                    <select name="system-theme" id="system-theme">
                        <option value='light'>Light</option>
                        <option value='dark'>Dark</option>
                    </select>                      
                </div>                        
            </div>
        </div>
        <div class="section" name="boot">
            <div class="section-header">Boot Settings</div>
            <div class="section-content">
                <div class="grid-2">
                    <span>Disable Wifi After</span>
                    <select name="disable-wifi-timer" id="disable-wifi-timer">
                        <option value="5">5 minutes</option>
                        <option  value="10">10 minutes</option>
                        <option  value="30">30 minutes</option>
                        <option  value="60">1 hour</option>                        
                        <option  value="never">Never</option>       
                    </select>                       
                </div> 
            </div>
        </div>
        <div class="section" name="backup">
            <div class="section-header">Backup</div>
            <div class="section-content">
                <a href="$_CONFIG_FILE?download=true" target="_blank">Download a copy</a> of your configuration so you can restore.
            </div>
        </div>
        <div class="section" name="restore">
            <div class="section-header">Restore</div>
            <div class="section-content">
                <label for="restoreSettings" class="link">Restore Settings</label><h6 class="text-muted">Restore from backup file.</h6>                
                <input id="restoreSettings" type="file" accept="text/json" onchange="restoreSettings();" style="display:none;">
            </div>
        </div>
        <div class="section" name="reset">
            <div class="section-header">Reset System</div>
            <div class="section-content">
                <label for="reset-button">Reset device</label>
                <button name="reset-button" onclick="reset()">Reset</button>                
            </div>
        </div>

        <div class="section" name="device-editor" id="device-editor">            
            <div class="content">
                <div class="flex">
                    <div>
                        <div class="grid-2">
                            <span>Device ID</span>
                            <div name="editor-device-id" id="editor-device-id"></div>
                        </div> 
                        <div class="grid-2">
                            <span>Device Name</span>
                            <input type="text" name="editor-device-name" id="editor-device-name"/>    
                        </div> 
                        <div class="grid-2">
                            <span>Device Type</span>
                            <div>
                                <select id="editor-device-type" name="editor-device-type">
                                    <optgroup label="Inputs">
                                        <option value="din">Digital Input</option>
                                        <option value="ain">Analig Input</option>   
                                        <option value="thermometer">Thermometer</option>
                                    </optgroup>
                                    <optgroup label="Outputs">
                                        <option value="relay">Relay</option>
                                    <option value="switch">Switch</option>        
                                    </optgroup>      
                                </select>
                            </div>
                        </div> 
                        <div class="grid-2">
                            <span>Device Pin</span>
                            <div>
                                <select id="editor-device-pin" name="editor-device-pin">
                                    <option value="4">D4</option>
                                    <option value="13">D13</option>
                                    <option value="18">D18</option>
                                    <option value="19">D19</option>
                                    <option value="21">D21</option>
                                    <option value="22">D22</option>
                                    <option value="23">D23</option>
                                    <option value="25">D25</option>
                                    <option value="26">D26</option>
                                    <option value="27">D27</option>
                                    <option value="32">D32</option>
                                    <option value="33">D33</option>                            
                                </select>
                            </div>
                        </div>  
                        <div class="grid-2"  id="editor-device-signal-container">
                            <span>Device Signal</span>
                            <div>
                                <select id="editor-device-signal" name="editor-device-signal">
                                    <option value="high">Active High</option>
                                    <option value="low">Active Low</option>
                                </select>
                            </div>
                        </div>                  
                    
                        <div class="grid-2" id="editor-device-use-trigger-container">
                            <span>Use Trigger</span>
                            <input type="checkbox" id="editor-device-use-trigger">
                        </div>
                    </div>
                    <div id="editor-device-trigger-panel">
                        
                        <div class="grid-2">
                            <span>Trigger Device</span>
                            <select id="editor-device-trigger-source-device">
                            </select>
                        </div>

                        <div class="grid-2">
                            <span>Trigger Type</span>
                            <select id="editor-device-trigger-type">
                                <option value="<"><</option>
                                <option value=">">></option>
                                <option value="=">=</option>
                            </select>
                        </div>

                        <div class="grid-2">
                            <span>Trigger Value</span>
                            <input type="number" id="editor-device-trigger-value">
                            </select>
                        </div>
                    </div>
                </div>
                
                
            </div>
        </div>


    </div>
</div>

<script type="text/javascript" src="/JS/esp32_config.js"></script>
<script type="text/javascript">
    window.onload = function() {
        //addCss('/CSS/style.css');
        //addCss('/CSS/config.css'); //can load from cache even on hard reload
        esp32_config_init('$_CONFIGURATION_DATA');
    }
</script>
    

